# Linux Basic

> 리눅스 기초: 쉘의 이해와 사용



### Unix OS

- 범용 다중 사용자 방식의 시분할 운영체제
- AT&T Bell Lab 개발자들이 주축이 되어 개발
- 초기 유닉스는 상업적으로 판매될 수 없어 소스코드와 함께 버클리 대학에 무상 제공
- AT&T 유닉스는 SysV 계열로 발전
- Solaris, HP-UX, AIX, SCO Unix, Ultrix, NeXTSTEP 등 다양한 변종으로 발전
- POSIX로 표준화
  - Portable Operating System Interface



### 실습 환경 설정

##### 가상 머신 설치

가상 머신 (virtual machine)

- 가상의 하드웨어를 사용하여 운영 체제 안에 도 다른 운영체제를 설치할 수 있도록 도와주는 프로그램

- 종류: vmware의 player, oracle의 <u>virtualbox</u>, ...

##### Ubuntu 설치

Ubuntu 20.04 LTS 이미지 파일(.iso) 필요

- 용량이 크기 때문에 설치 경로는 웬만하면 시스템 폴더(C:) 말고 다른 곳으로 

- 메모리는 권장 2GB 이상, 사이즈는 20GB Dynamically allocated
- VDI 파일

##### virtualbox 설정

- 클립보드 공유, 드래그 앤 드롭 양방향
- 프로세서 2개
- 비디오 메모리 128mb
- Host-only Adapter 추가 



### 단축키

터미널 창 띄우기 `ctrl + alt + t`

터미널 탭 띄우기 `ctrl + shift + t`

터미널 창/탭 닫기 `ctrl + shift + w`



### 명령어

##### 명령어의 개념

- 일반적으로 실행 가능한 프로그램(앱)

##### 명령어의 입력

- 명령어는 공백이나 탭으로 구분되는 하나 이상의 단어로 시작하고, 마지막에 엔터를 입력해야 함 (개행 문자로 끝나야 함)

##### 다수의 명령어 실행

- shell prompt 상에서 2개 이상의 명령어를 실행하고 싶다면, 명령어를 구분하기 위한 구분자로 `;`를 사용

##### 명령어 히스토리

- shell prompt 상에서 입력한 명령어를 다시 보여 주는 기능
- 방향키 위, 아래를 이용해 하나씩 볼 수 있음
- `history` 명령어를 이용해 확인 가능
  - `!<명령어 번호>` 입력으로 해당 명령어 실행
  - `!!` 입력으로 마지막 명령어 실행 

##### 명령어의 옵션

- `-option`

- 다수의 옵션을 사용할 수 있음
  - `ls -a -l -h`
  - 여러 개를 붙여서 쓸 수 있음. 예를 들면, `ls -alh`
- long option `--all` 

##### 명령어의 인자

명령어와 옵션이 아닌 단어(token)을 인자(argument)

##### 명령어 도움말

`<command> --help`



### 기본 명령어

`clear`, `ctrl + l` 화면 지우기

`date` 날짜-시간 확인하기

`cal` 달력

- `cal <month> <year>`

`exit`  종료

`pwd` 

`echo` 지정한 문자열을 터미널에 출력

- 그룹화가 되는 경우 해당되는 파일명을 출력



## Shell의 개념

#### Shell의 이해

![image-20220614133811564](assets/image-20220614133811564.png)

- Shell이란 키보드로 입력한 명령어를 운영체제에 전달하여 그 명령어를 실행하게 하는 프로그램
- 기본적인 의미는 껍데기, 이는 사용자와 운영체제의 내부(커널) 사이의 인터페이스를 감싸는 층
- 일반적으로 <u>command line</u>, <u>graphic shell</u> 두 종류로 분류됨
- command line은 운영체제 상에서 CLI(Command Line Interface)를 제공하는 반면, graphic shell은 GUI(Graphic User Interface)를 제공



#### Bash

- Bourne Again Shell
- 최초의 Unix Shell 프로그램인 sh의 확장판
- GNU 운영체제와 리눅스 등 운영 체제에 기본 쉘로 탑재



#### Shell Prompt

- CLI(Command Line Interface)
- `username@hostname:directory$`
- prompt 마지막 글자가 `$`가 아니라 `#`일 경우, 관리자 권한을 가진 사용자로 로그인 했음을 의미



## 파일 시스템

#### 파일 시스템

- File system이란 컴퓨터에서 파일이나 자료를 쉽게 발견 및 접근할 수 있도록 보관 또는 조직하는 체제를 의미
- 리눅스에서 일반적으로 사용되는 파일 시스템은 ext(extended file system, 확장 파일 시스템), Stephen Tweedie가 제작하여 1992년 4월 발표함
- 종류로 ext, ext2, ext3, ext4가 있음

#### 파일 시스템 구조

- 계층적인 디렉토리 구조로 파일을 구성함
- 트리 형식으로 디렉토리(Windows에서 폴더)를 구성하고, 각 디렉토리에는 파일이나 다른 디렉토리가 포함될 수 있음
- 파일 시스템의 최상위 디렉토리(`/`)를 root 디렉토리라고 하며, 파일들과 하위 디렉토리를 포함하고 있음
- Windows와 달리 Linux 시스템에서는 단일 파일 시스템으로 관리함

#### 사용자 디렉토리(폴더)

현대의 운영체제는 다중 사용자의 개념을 제공

사용자 디렉토리란 각 사용자에게 개별적으로 부여된 고유한 공간

- Windows: 홈 폴더 (home folder)
  - `C:\Users\username`
- Linux: 홈 디렉토리 (home directory)
  - `/` : root
  - `/home/username`
  - 사용자가 터미널 상에서 로그인을 하면 사용자의 작업 디렉토리를 홈 디렉토리로 이동
  - 일반 사용자를 위하여 읽고 쓰기 권한이 부여된 유일한 공간 

#### 현재 작업 디렉토리 출력

- 사용자가 위치해 있는 지점을 현재 디렉토리라고 함
- `pwd` 명령어로 출력

#### 현재 작업 디렉토리 변경

`cd <path>`

- 현재 작업 중인 디렉토리를 변경
- 절대 경로, 상대 경로 모두 사용

홈 디렉토리 이동

- `cd`
- `cd ~`

하위 디렉토리 이동

- `cd ./Desktop`
- 상대 경로를 사용하지 않으면 현재 디렉토리 안에서 해당 디렉토리를 찾음

직전 디렉토리 이동 

- `cd -`

#### 절대 경로, 상대 경로 

##### path

- 파일 시스템에서 디렉토리나 파일의 위치를 표현하기 위한 방법
- 파일과 디렉토리 또는 디렉토리와 디렉토리의 이동 경로

##### 절대 경로

- `/`를 기준으로 특정 디렉토리 또는 파일까지의 경로

##### 상대 경로

- 현재 작업 디렉토리로부터 다른 디렉토리 또는 파일까지의 경로
- `.` 현재 작업 디렉토리, `..` 현재의 상위 디렉토리

#### 디렉토리 내용 확인

 **디렉토리의 내용 확인** `ls`

- ls 다음에 절대 경로명 또는 상대 경로명을 사용할 수 있음
- 옵션
  - `-a`: 모든 파일 보기. 숨김 파일까지 표시.
  - `-d`: ls 명령어에 디렉토리를 명시하면 해당 디렉토리 자체가 아닌 디렉토리 내용을 출력. 이 때, 이 옵션을 사용하면 디렉토리 내용이 아닌 디렉토리 자체를 출력
  - `-l`: 좀 더 자세한 정보를 출력
  - `-h`: 폴더 용량을 보기 좋게 출력
  - `-r`: 출력 결과를 역순으로 표시 
  - `-S`: 파일 크기 순으로 정렬
  - `-t`: 파일 수정 시간 순으로 정렬
  - `-F`: 파일 경로 `/`까지 표시 


**디렉토리의 상세한 내용 확인** `ll`

- `ls -al`와 동일

`ll`, `ls -l` **출력 형식** 

``` bash
drwxr-xr-x 2 hello hello 4096 6월 14 11:10 Desktop
```

- 첫 번째 문자: 파일의 종류 

  - d: directory를 의미

  - f: file을 의미

- 두 번째 이후 문자: 파일의 권한

  - r: read
  - w: write
  - x: execute

#### 파일 전체 내용 확인

- 텍스트 파일 전체를 확인하려면 `cat` 명령어 사용
- 옵션
  - `-n`: 줄 번호를 붙임
  - `-b`: 텍스트가 있는 줄에만 번호를 붙임
  - `-T`: 탭 문자를 `^I`로 표시
- 파일 내용이 긴 경우 스크롤해가며 봐야함

#### 파일을 페이지 단위로 확인

- 텍스트 파일을 화면 단위로 확인하려면 `more` 명령어 사용
- 자주 사용되는 키
  - `spacebar`, `f` : 다음 페이지 이동
  - `b`: 이전 페이지 이동
  - `enter`: 라인 단위로 이동
  - `/<string>`: 아래 방향으로 문자열 검색, `n`으로 다음 검색
  - `q`: 종료

#### 파일 내용 확인 

- 텍스트 파일을 볼 때 `less` 명령어를 가장 많이 사용
- 자주 사용되는 키 
  - `PgUp`, `b`: 한 페이지 위로
  - `PgDn`, `spacebar`: 한 페이지 아래로
  - `↑`: 한 줄 위로
  - `↓`: 한 줄 아래로
  - `G`: 텍스트 파일 맨 마지막으로
  - `1G`, `g`: 텍스트 파일 맨 처음으로
  - `/<string>`: 아래 방향으로 문자열 검색, `n`으로 다음 검색
  - `h`: 도움말 보기
  - `q`: 프로그램 종료

#### 파일의 일부 내용 출력

- `head`: 파일의 첫 10줄 출력
- `tail`: 파일의 마지막 10줄 출력
- `-n` 명령어를 이용해 출력할 행의 개수를 조정할 수 있음
  - `head -n 5 .bashrc`

#### 파일 종류 확인

- 리눅스에서는 확장자의 개념이 없음
- `file` 명령어를 이용해 파일의 종류 또는 정보를 확인

#### 참고

- 장치 파일은 유닉스 계열 운영체제에서 하드웨어를 관리하기 위해 제공되는 일종의 특수 파일
- 파일 입출력 시스템 콜을 사용해 장치 드라이버와 상호작용 할 수 있게 해줌
- 파일명에 공백을 포함할 수 있다
- 파일명은 대소문자를 구분 



## 파일과 디렉토리

#### 와일드카드

- shell은 파일에 대한그룹을 지정할 수 있도록 특수한 문자를 제공하는데, 이를 와일드카드 또는 글로빙(globbing)이라 함
- shell이 제공하는 와일드카드
  - `*` 0개 이상의 모든 문자
  - `?` 1개의 모든 문자
  - `[characeters]` characters 문자셋에 포함된 문자
  - `[!characters]` characters 문자셋에 포함되지 않은 문자
  - `[[:class]]` 지정된 문자 클래스에 포함된 문자
- 와일드카드를 단순 문자로 해석하게 하려면 앞에 `/`를 붙이기
- 자주 사용되는 문자 클래스
  - `[:alnum:]` 모든 알파벳과 숫자 문자
  - `[:alpha:]` 모든 알파벳 문자 
  - `[:digit:]` 모든 숫자
  - `[:lower:]` 모든 소문자
  - `[:upper:]` 모든 대문자
- 예시
  - `echo /usr/bin/z*p`
  - `echo /usr/bin/??`
  - `[a-z]`, `[a-zA-Z]`

#### 디렉토리 생성

`mkdir`

- 파일명에 공백 포함 가능 `''`로 묶어주기, 권장하지 않음

#### 파일 및 디렉토리 복사

`cp`

- `cp file1 file2`: file1을 file2에 덮어쓰고, 없으면 새로 생성
- `cp file1 file2 dir1`: file1, file2를 dir1에 복사, dir1은 미리 존재해야 함
- `cp dir1/* dir2`: dir1의 모든 파일은 dir2에 복사, dir2는 미리 존재해야 함
- `cp -r dir1 dir2`:  dir1의 모든 파일을 dir2에 복사, dir2가 없으면 생성됨

#### 파일 이동 및 이름 변경

`mv`

- 파일을 이동하는 경우, 파일 이름을 변경하는 경우
- `mv file1 file2`: file1을 file2로 이름 변경, file2가 이미 있는 경우 덮어씀
- `mv file1 file2 dir`:  file1, file2를 dir1로 이동, dir1은 미리 존재해야 함
- `mv dir1 dir2`: dir1을 dir2로 이동, dir2가 없다면 이름만 변경

#### 파일 및 디렉토리 삭제

`rm`

- `-r` 재귀적으로 디렉토리 삭제
- `-f` 존재하지 않는 파일에 대하여 확인 메시지 없이 삭제 
- `rm file1` file1 완전히 삭제
- `rm -r file1 dir1` file1, dir1 및 하위 내용 모두 삭제
- `rm -rf *`

`rmdir`은 비어있는 디렉토리에만 사용 가능

`rm` 사용 시 먼저 테스트 해보는 것이 좋음

- `rm * .html`을 쓰려는 경우 `ls * .html`을 써보기

#### 하드 링크, 심볼릭 링크

##### 하드 링크

같은 파일에 다른 이름(alias)를 부여하는 개념 `ln 파일명 링크명`

- 하드 링크는 파일 시스템 외부에 있는 파일을 참조할 수 없으며, 같은 디스크 파티션에 있는 파일만 참조 가능

- 하드 링크는 디렉토리를 참조할 수 없음
- `.`, `..` 는 하드 링크로, 예외적으로 허용됨

##### 심볼릭 링크

하드 링크의 한계를 극복하기 위해 도입된 개념 `ln -s 파일명 링크명`

- 참조될 파일이나 디렉토리를 가리키는 텍스트 포인터가 포함된 특수한 파일을 생성

##### 링크의 개념

같은 파일에 다른 이름(별칭)을 부여하는 개념 

링크의 개념이 없을 경우, 여러 문제가 발생

- 예) 특정 파일의 이름을 변경하는 경우
  - 원래 파일의 복사본을 만들고 기존에 있던 파일을 삭제하는 방식으로 진행
  - 링크를 사용하면 복사, 제거에 대한 오버헤드가 없이 파일의 이름을 변경할 수 있음



## 기본 명령어

#### 명령어의 종류

파일로 존재하는 실행 프로그램

- C/C++ 언어로 작성된 프로그램처럼 컴파일 된 바이너리 형식의 파일 또는 Shell, Perl, Python, Ruby와 같은 스크립트 언어로 만든 프로그램
- Shell에 내장되어 있는 명령어. bash는 다수의 내장 명령어를 지원 (cd, ...)
- Shell 함수
- 별칭으로 다른 명령어로부터 사용하여 새롭게 정의된 명령어

#### 명령어 타입 출력

`type` 명령어 사용

#### 실행 프로그램의 위치 확인

`which` 명령어 사용

#### 명령어의 도움말 확인 

`help 명령어` 내장 명령어에 대한 도움말

`명령어 --help` 일반적으로 명령어에 대한 도움말

`man 명령어`

- 프로그램 매뉴얼 페이지 (manual)
- 1. 사용자 명령어
  2. 커널 시스템콜 API
  3. C 라이브러리 API
  4. 장치 노드 및 드라이버와 같은 특수 파일
  5. 파일 포맷
  6. 스크린 세이버와 같은 게임이나 미디어 파일
  7. 그 외 여러 종류
  8. 시스템 관리용 명령어

#### man 명령어의 검색

`apropos 명령어`

- man 명령어가 제공하는 도움말이 매우 방대하여 검색의 어려움이 있음
- man 명령어가 제공하는 도움말에 대해 검색을 수행할 수 있도록 

`whatis 명령어`

- man 명령어에 대한 간략 정보 출력

#### uniq

`uniq 파일명`

- 입력된 파일에 대해 중복된 행이 연속되어 있을 때 한 행만 남기고 삭제하는 명령어
- 옵션
  - `-c` 중복된 행의 개수를 출력
  - `-d` 중복된 행에 대하여 한 행만 출력
  - `-D` 중복된 행에 대하여 모든 행을 출력
  - `-u` 중복된 행이 아닌 것만 출력

#### sort

`sort 파일명`

- 지정한 파일의 내용을 정렬할 때 사용
- 옵션
  - `-f` 영어를 정렬할 때, 대소문자 구별 안함
  - `-r` 출력 순서를 역순으로
  - `-o` 저장할 파일명을 명시, 명시하지 않으면 화면에 출력
  - `-k <column>` 특정 열을 기준으로 정렬, 열 번호는 1부터 시작
  - `-t` 특정 구분자를 기준으로 각 열을 구분
  - `-n` 열을 수로 해석해 달라는 의미
    - `sort -t ';' -k 4 -n /etc/passwd`

#### wc

`wc 파일명`

- 입력된 파일에 대하여 단어의 개수를 출력하는 명령어
- 옵션
  - `-c` 문자 수만 보여줌
  - `-m` 캐릭터 수만 보여줌
  - `-l` 라인 수만 보여줌
  - `-w` 단어 수만 보여줌
  - `-L` 가장 긴 줄의 길이를 보여줌

#### 세미콜론

`;`을 사용하면 커맨드라인에서 2개 이상의 명령어를 실행할 수 있음

#### 새로운 명령 생성

`alias 새명령어='기존명령어'`

- 기존의 명령어를 사용해 새로운 명령어를 생성 (ex. `alias foo='cd /; ls; cd'`)
- `unalias` 명령어를 사용해 삭제

#### 표준 스트림

![마음대로 적는)라즈베리파이2 기초 – 4. 리눅스 프로그래밍(4) : 클리앙](https://scweeny.net/wp-content/uploads/2016/05/%EC%9D%B4%EB%AF%B8%EC%A7%80103.png)

프로그램과 사용자의 터미널(모니터와 키보드가 있는 단말기) 사이에 미리 연결된 <u>입출력 통로</u>

터미널의 입출력은 주로 키보드와 모니터를 통해 일어나는데, 표준 스트림은 이를 추상화 한 것

- 표준 입력 스트림: 입력을 위한 스트림, 쉘에서는 0으로 표현
- 표준 출력 스트림: 출력을 위한 스트림, 쉘에서는 1로 표현
- 표준 에러 스트림: 오류 메시지 출력을 위한 스트림, 쉘에서는 2로 표현
  - 입/출력 스트림의 경우에는 장치 별 속도를 맞추기 위한 버퍼가 존재
  - 버퍼는 프로그램이 비정상 종료되면 같이 사라지기 때문에, 에러를 출력하기 위해 에러 스트림이 존재

#### 리다이렉션

`명령어 > 파일명`

- `<` 입력 방향을 재지정
- `>` 출력 방향을 재지정
- `>>` 출력에 덮어쓰지 않고 덧붙인다(append)
- `2>` 오류의 방향을 재지정
- `&>` 출력과 오류를 재지정
- `>&` 오류와 출력을 재지정(권장)
- `1>&2` 출력을 오류로 내보낸다
- `2>&1` 오류를 출력으로 내보낸다

#### cat

`cat 파일명`

다수의 파일을 연결하기 위한 명령어 (concatenate)

- 와일드카드는 항상 정렬된 순서로 확장